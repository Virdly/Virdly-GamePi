# Virdly-GamePi

[![Release](https://img.shields.io/github/v/release/Virdly/Virdly-GamePi?style=for-the-badge&color=blue)](https://github.com/Virdly/Virdly-GamePi/releases)
[![License](https://img.shields.io/github/license/Virdly-Virdly-GamePi?style=for-the-badge)]
[![Platform](https://img.shields.io/badge/Platform-Raspberry%20Pi%20Pico%20RP2040-blueviolet?style=for-the-badge)]
[![Status](https://img.shields.io/badge/Status-In%20Development-yellow?style=for-the-badge)]

Краткое описание
----------------
Пользовательская прошивка для устройств на базе Waveshare RP2040 PiZero в связке с GamePi13. Небольшая, настраиваемая система управления с графическим интерфейсом, поддерживающая хранение настроек в файловой системе и базовые средства кастомизации интерфейса.

Оглавление
---------
- [Ключевые возможности](#ключевые-возможности)
- [Поддерживаемое оборудование](#поддерживаемое-оборудование)
- [Быстрый старт](#быстрый-старт)
- [Структура проекта](#структура-проекта)
- [Конфигурация](#конфигурация)
- [Разработка и сборка](#разработка-и-сборка)
- [Вклад в проект](#вклад-в-проект)
- [Лицензия](#лицензия)
- [Контакты и благодарности](#контакты-и-благодарности)

Ключевые возможности
-------------------
| Функция | Статус |
|--------:|:------|
| Графический интерфейс (ST7789) | реализовано |
| Сохранение настроек (LittleFS) | реализовано |
| Кастомизация цветов текста | реализовано |
| Управление звуком | реализовано |
| Файловый менеджер | в разработке |
| Загрузка программ | в разработке |
| Сброс настроек | реализовано |
| Управление через Serial | реализовано |

Поддерживаемое оборудование
--------------------------
- Микроконтроллер: Waveshare RP2040 PiZero
- Дисплей: ST7789 (240×240)
- Контроллер ввода: GamePi13 (3 кнопки: Up, Y, Down)
- Память: 16 MB Flash (рекомендуемая разделка: Sketch 11 MB, FS 5 MB)

Быстрый старт
-------------
1. Перейдите в раздел релизов: https://github.com/Virdly/Virdly-GamePi/releases  
2. Подключите устройство в режиме загрузчика (удерживайте BOOT при подключении по USB).  
3. Скопируйте файл `Virdly-GamePi.uf2` на появившийся диск `RPI-RP2`.  
4. Устройство автоматически перезагрузится в прошивку.

Структура проекта
-----------------
Проект ориентирован на простую сборку в Arduino IDE. Рекомендуемая структура:

- VirdlyGamePi13.ino — основной файл прошивки  
- MenuView.ino — функции отрисовки меню и навигации  
- Bitmaps.h — графические ресурсы (иконки, битмапы)  
- Bahamas6.h — шрифт(ы)  
- Settings.h — значения по умолчанию и конфигурации компиляции  
- VConfig.json — конфигурационный файл, создаётся/обновляется прошивкой  
- LICENSE, Changelog и прочие служебные файлы

Конфигурация
------------
Формат конфигурации в файле VConfig.json — JSON с двумя основными секциями: Design и Variables.

Пример VConfig.json:
```json
{
  "Design": {
    "TextColor": "ST77XX_WHITE"
  },
  "Variables": {
    "AudioCheck": 1
  }
}
```

Поддерживаемые значения цвета:
- ST77XX_WHITE
- ST77XX_BLACK
- ST77XX_RED
- ST77XX_GREEN
- ST77XX_BLUE

Настройки по умолчанию и поведение при сбросе
--------------------------------------------
В файле Settings.h указаны значения, которые служат настройками по умолчанию и применяются при сбросе прошивки к заводским параметрам (reset):

```cpp
#define TEXTCB ST77XX_WHITE   // Цвет текста по умолчанию при сбросе
#define FONECB ST77XX_BLACK   // Цвет фона по умолчанию при сбросе
#define AUDIOCB true          // Включён звук по умолчанию при сбросе
```

Если пользователь выполняет сброс настроек к заводским, прошивка восстановит эти значения в конфигурации.

Сериальное управление
---------------------
Прошивка поддерживает простые команды по Serial (115200 бод). Примеры использования на Python:

```python
import serial
ser = serial.Serial('COM3', 115200)  # укажите порт

# Изменить параметры: текст в красном и включить звук
ser.write(b'SetConfig=ST77XX_RED,1;')

# Отправить JSON с новой конфигурацией
ser.write(b'VCONFIG={\"Design\":{\"TextColor\":\"ST77XX_GREEN\"},\"Variables\":{\"AudioCheck\":0}};')
```

Интерфейс пользователя и управление
----------------------------------
Управление реализовано через три аппаратные кнопки:
- UP — перемещение вверх
- Y — выбор / подтверждение
- DOWN — перемещение вниз

Примерная структура меню:
- Главное меню
  - Настройки
    - Звук (Вкл/Выкл)
    - Кастомизация
      - Белый текст
      - Черный текст
      - Красный текст
      - Зеленый текст
      - Синий текст
    - Сброс настроек
    - Форматирование
  - Файлы
  - Программы (в разработке)
  - Информация

Разработка и сборка
------------------
Рекомендации для сборки в Arduino IDE:

1. Установите Arduino IDE (рекомендуется версия 2.x).  
2. В "Файл → Настройки → Дополнительные платы" добавьте:
```
https://github.com/earlephilhower/arduino-pico/releases/download/global/package_rp2040_index.json
```
3. В Меню Платы выберите: Raspberry Pi Pico/RP2040 → Waveshare RP2040-Zero.  
4. Настройте параметры платы:
   - Flash Size: 16MB (Sketch: 11MB, FS: 5MB)
   - CPU Speed: 200 MHz
   - Upload Method: UF2 (по умолчанию)
5. Установите через Library Manager: LittleFS, ArduinoJson, Adafruit_ST7789, Adafruit_GFX, GyverButton.  
6. Откройте VirdlyGamePi13.ino и выполните загрузку.

Команды для клонирования и локальной работы:
```bash
git clone https://github.com/Virdly/Virdly-GamePi.git
cd Virdly-GamePi
# открыть проект в Arduino IDE или PlatformIO для дальнейшей работы
```

Вклад в проект
--------------
Правила вклада:
1. Форкните репозиторий.  
2. Создайте ветку: `git checkout -b feature/ваша-фича`.  
3. Внесите изменения, оформите коммиты.  
4. Запушьте ветку и откройте Pull Request с описанием изменений и тестов.

Лицензия
--------
Проект распространяется под лицензией MIT. Полный текст — в файле LICENSE.

Контакты и благодарности
-----------------------
Автор: Rubuhs (GitHub: @Virdly)  
Благодарности: команде Waveshare, разработчикам arduino-pico и сообществу Arduino за библиотеки и поддержку.
